<div class="row no-bottom-margin">
  <div class="input-field col s12">
    <div class="admin-search-form">
      <%= form_tag(path, method: "get", id: "#{search_type}-form", remote: true) do %>
        <%= text_field_tag search_type, params[search_type], placeholder: "Search" %>
      <% end %>
      <%= render 'administration/admin_search_spinner', search_type: search_type %>
    </div>
  </div>
</div>

<% content_for :javascript do %>
  <script type="text/javascript">
    $(document).ready(function() {

      $('#<%= search_type %>-form').on('ajax:beforeSend', function(ev) {
        $(this).hide()
        $("#loading-spinner-<%= search_type %>").show()
      }).on('ajax:complete', function(ev) {
        $(this).show()
        $("#loading-spinner-<%= search_type %>").hide()
      })

      var sendQuery = function() { $(this).submit() }

      $('#<%= search_type %>-form').on('keyup', _.debounce(sendQuery, 300))

    });
  </script>
<% end %>
